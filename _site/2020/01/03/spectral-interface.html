<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta name="googlebot" content="noindex">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="Cache-control" content="public">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <title></title>
  <meta name="keys" content="">
  <meta property="og:title" content="">
  <meta property="og:type" content="article">
  <!-- for google -->
  <meta itemprop="name" content="">
  <meta itemprop="description" content="">
  

  <!-- links -->
<link rel="stylesheet" href="http://localhost:4000/assets/main.css">
<link rel="shortcut icon" href="http://localhost:4000/assets/img/favicon.ico" type="image/x-icon" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  
<!--
<link rel="stylesheet" href="http://localhost:4000/assets/tipuesearch/css/normalize.css">
<link rel="stylesheet" href="http://localhost:4000/assets/tipuesearch/tipuesearch.css">
-->
<script src="http://localhost:4000/assets/tipuesearch/tipuesearch_content.js"></script>
<script src="http://localhost:4000/assets/tipuesearch/tipuesearch_set.js" ></script>
<script src="http://localhost:4000/assets/tipuesearch/tipuesearch.min.js" ></script>
</head><body><header class="top_header">
  <a href="http://localhost:4000" class="logo">Logo</a>
  <form class="top_search" action="http://localhost:4000/search">
    <div class="tipue_search_left">
      <div class="tipue_search_close hidden">✕</div>
      <img src="/assets/tipuesearch/search.png" class="tipue_search_icon">
    </div>
    <div class="tipue_search_right ">
      <input type="text" name="q" id="tipue_search_input" class="tipue_search_input" pattern=".{3,}" title="At least 3 characters" required>
    </div>
    <div style="clear: both;"></div>
  </form>
</header><main class="page-content" aria-label="Content">
		<aside class="left_sidebar page_sidebar">
  <div class="hide_large post_toggler" id="left_toggler">
    <span> &#31;</span>
    <span class="hidden"> &#30;</span>
    <div>Site navigation</div>
  </div>
  <div class="filters">
    <h2>Filters:</h2>
    <span class="choice active all" data-type="all">All</span>
    <span class="choice tags" data-type="tags">Tags</span>
    <span class="choice categories" data-type="categories">Categories</span>
    <span class="choice years" data-type="years">Years</span>
  </div>
  <div class="post_aside post_all pal ">
    <h2>All Posts:</h2>
    
      <a href="http://localhost:4000/2020/01/03/spectral-interface.html"
       class="active" 
      >
        Spectral Interface</a>
    
      <a href="http://localhost:4000/jekyll/run/debug/2019/12/31/working-with-run-debug.html"
      
      >
        Work with run/debug configurations</a>
    
      <a href="http://localhost:4000/jekyll/update/2019/12/30/welcome-to-jekyll.html"
      
      >
        Welcome to Jekyll!</a>
    
      <a href="http://localhost:4000/2018/01/12/readme.html"
      
      >
        Readme</a>
    
      <a href="http://localhost:4000/2017/05/24/Markdownsource.html"
      
      >
        Markdownsource</a>
    
      <a href="http://localhost:4000/2017/05/24/Markdown-here.html"
      
      >
        Markdown Here</a>
    
  </div>

  <div class="post_aside post_tags pal hidden">
    <h2>Tags</h2>
    
    <details>
      <summary>markdown</summary>
      
      <a href="http://localhost:4000/2017/05/24/Markdownsource.html">Markdownsource</a>
      
      <a href="http://localhost:4000/2017/05/24/Markdown-here.html">Markdown Here</a>
      
    </details>
    
    <details>
      <summary>opera</summary>
      
      <a href="http://localhost:4000/2017/05/24/Markdown-here.html">Markdown Here</a>
      
    </details>
    
    <details>
      <summary>github</summary>
      
      <a href="http://localhost:4000/2017/05/24/Markdown-here.html">Markdown Here</a>
      
    </details>
    
    <details>
      <summary>source</summary>
      
      <a href="http://localhost:4000/2017/05/24/Markdownsource.html">Markdownsource</a>
      
    </details>
    
    <details>
      <summary>jekyll</summary>
      
      <a href="http://localhost:4000/jekyll/run/debug/2019/12/31/working-with-run-debug.html">Work with run/debug configurations</a>
      
      <a href="http://localhost:4000/jekyll/update/2019/12/30/welcome-to-jekyll.html">Welcome to Jekyll!</a>
      
      <a href="http://localhost:4000/2018/01/12/readme.html">Readme</a>
      
    </details>
    
    <details>
      <summary>code</summary>
      
      <a href="http://localhost:4000/jekyll/run/debug/2019/12/31/working-with-run-debug.html">Work with run/debug configurations</a>
      
      <a href="http://localhost:4000/jekyll/update/2019/12/30/welcome-to-jekyll.html">Welcome to Jekyll!</a>
      
    </details>
    
    <details>
      <summary>spectral</summary>
      
      <a href="http://localhost:4000/2020/01/03/spectral-interface.html">Spectral Interface</a>
      
    </details>
    
    <details>
      <summary>python</summary>
      
      <a href="http://localhost:4000/2020/01/03/spectral-interface.html">Spectral Interface</a>
      
    </details>
    
    <details>
      <summary>network</summary>
      
      <a href="http://localhost:4000/2020/01/03/spectral-interface.html">Spectral Interface</a>
      
    </details>
    
  </div>

  <div class="post_aside post_categories pal hidden">
    <h2>Categories</h2>
    
    <details>
      <summary>jekyll</summary>
      
      <a href="http://localhost:4000/jekyll/run/debug/2019/12/31/working-with-run-debug.html">Work with run/debug configurations</a>
      
      <a href="http://localhost:4000/jekyll/update/2019/12/30/welcome-to-jekyll.html">Welcome to Jekyll!</a>
      
    </details>
    
    <details>
      <summary>update</summary>
      
      <a href="http://localhost:4000/jekyll/update/2019/12/30/welcome-to-jekyll.html">Welcome to Jekyll!</a>
      
    </details>
    
    <details>
      <summary>run</summary>
      
      <a href="http://localhost:4000/jekyll/run/debug/2019/12/31/working-with-run-debug.html">Work with run/debug configurations</a>
      
    </details>
    
    <details>
      <summary>debug</summary>
      
      <a href="http://localhost:4000/jekyll/run/debug/2019/12/31/working-with-run-debug.html">Work with run/debug configurations</a>
      
    </details>
    
  </div>
  <div class="post_aside post_years pal hidden">
    
    
    
    
    <h2 class="post-list-heading">Posts list</h2>
    <div class="post-list">
      
      <details>
        <summary class="post-meta">2017</summary><a class="post-link" href="http://localhost:4000/2017/05/24/Markdownsource.html">
          Markdownsource
        </a><a class="post-link" href="http://localhost:4000/2017/05/24/Markdown-here.html">
          Markdown Here
        </a></details>
      
      <details>
        <summary class="post-meta">2018</summary><a class="post-link" href="http://localhost:4000/2018/01/12/readme.html">
          Readme
        </a></details>
      
      <details>
        <summary class="post-meta">2019</summary><a class="post-link" href="http://localhost:4000/jekyll/run/debug/2019/12/31/working-with-run-debug.html">
          Work with run/debug configurations
        </a><a class="post-link" href="http://localhost:4000/jekyll/update/2019/12/30/welcome-to-jekyll.html">
          Welcome to Jekyll!
        </a></details>
      
      <details>
        <summary class="post-meta">2020</summary><a class="post-link" href="http://localhost:4000/2020/01/03/spectral-interface.html">
          Spectral Interface
        </a></details>
      
    </div>
    
  </div>
</aside>
		<div>
			<article class="post h-entry wrapper" itemscope itemtype="http://schema.org/BlogPosting">
    <div class="post_grid">
        <div class="post-header">
            <h1 class="post-title p-name" id="spectral-interface" itemprop="name headline">SPECTRAL INTERFACE</h1>
            <p class="post-meta">
                <time class="dt-published" datetime="2020-01-03T00:00:00+02:00" itemprop="datePublished">Jan 3, 2020
      </time></p>
        </div>

        <div class="post-content e-content" itemprop="articleBody">
            <p>SpIN requires a working installation of Python and TensorFlow. We recommend
running it on GPU for faster convergence.</p>

<h2 id="spectral-inference-networks-spin">Spectral Inference Networks (SpIN)</h2>

<p>This package provides an implementation of Spectral Inference Networks,
as in <a href="https://arxiv.org/abs/1806.02215">Pfau, Petersen, Agarwal, Barrett and Stachenfeld (2018)</a>.</p>

<p>This is not an officially supported Google product.</p>

<h2 id="prerequisites">Prerequisites</h2>
<p>SpIN requires a working installation of Python and TensorFlow. We recommend
running it on GPU for faster convergence.</p>

<p>If you want to make use of the GUI (on by default) you will also need Tcl/Tk
installed on your system.</p>

<h2 id="installation">Installation</h2>
<p>After cloning the repo, run pip to install the package and its Python
dependencies:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>spectral_inference_networks
pip <span class="nb">install</span> <span class="nb">.</span>
</code></pre></div></div>

<h2 id="usage">Usage</h2>
<p>Training a spectral inference network is similar to most other deep learning
pipelines: you must construct a data source, network architecture and optimizer.
What makes spectral inference networks unique is that instead of a loss you
provide a linear operator to diagonalize. The code expects an object of the
LinearOperator class, which can be constructed from a similarity kernel or by
other means. LinearOperator objects can be added together or multiplied by a
scalar.</p>

<p>Below is a minimal example of training spectral inference networks:</p>

<p>```python
import tensorflow as tf
import spectral_inference_networks as spin</p>

<p>batch_size = 1024
input_dim = 10
num_eigenvalues = 5
iterations = 1000  # number of training iterations</p>

<h2 id="create-variables-for-simple-mlp">Create variables for simple MLP</h2>
<p>w1 = tf.Variable(tf.random.normal([input_dim, 64]))
w2 = tf.Variable(tf.random.normal([64, num_eigenvalues]))</p>

<p>b1 = tf.Variable(tf.random.normal([64]))
b2 = tf.Variable(tf.random.normal([num_eigenvalues]))</p>

<h2 id="create-function-to-construct-simple-mlp">Create function to construct simple MLP</h2>
<p>def network(x):
  h1 = tf.nn.relu(tf.matmul(x, w1) + b1)
  return tf.matmul(h1, w2) + b2</p>

<p>data = tf.random.normal([batch_size, input_dim])  # replace with actual data</p>
<h2 id="squared-exponential-kernel">Squared exponential kernel.</h2>
<p>kernel = lambda x, y: tf.exp(-(tf.norm(x-y, axis=1, keepdims=True)**2))
linop = spin.KernelOperator(kernel)
optim = tf.train.AdamOptimizer()</p>

<h2 id="constructs-the-internal-training-ops-for-spectral-inference-networks">Constructs the internal training ops for spectral inference networks.</h2>
<p>spectral_net = spin.SpectralNetwork(
    linop,
    network,
    data,
    [w1, w2, b1, b2])</p>

<h2 id="trivial-defaults-for-logging-and-stats-hooks">Trivial defaults for logging and stats hooks.</h2>
<p>logging_config = {
    ‘config’: {},
    ‘log_image_every’: iterations,
    ‘save_params_every’: iterations,
    ‘saver_path’: ‘/tmp’,
    ‘saver_name’: ‘example’,
}</p>

<p>stats_hooks = {
    ‘create’: spin.util.create_default_stats,
    ‘update’: spin.util.update_default_stats,
}</p>

<h2 id="executes-the-training-of-spectral-inference-networks">Executes the training of spectral inference networks.</h2>
<p>stats = spectral_net.train(
    optim,
    iterations,
    logging_config,
    stats_hooks)</p>

        </div>

    </div><a class="u-url" href="/2020/01/03/spectral-interface.html" hidden></a>

</article>
		</div>
		<aside class="page_sidebar right_sidebar">
  
  <div class="hide_large page_toggler" id="right_toggler">
    <span> &#31;</span>
    <span class="hidden"> &#30;</span>
    <div>Page navigation</div>
  </div>
  <div class="page_nav post_aside hide_small" id="page_nav">
    <h2>Titles:</h2>
    
      <a href="#spectral-inference-networks-spin" class="in_link">Spectral Inference Networks (SpIN)</a>
    
      <a href="#prerequisites" class="in_link">Prerequisites</a>
    
      <a href="#installation" class="in_link">Installation</a>
    
      <a href="#usage" class="in_link">Usage</a>
    
      <a href="#create-variables-for-simple-mlp" class="in_link">Create variables for simple MLP</a>
    
      <a href="#create-function-to-construct-simple-mlp" class="in_link">Create function to construct simple MLP</a>
    
      <a href="#squared-exponential-kernel." class="in_link">Squared exponential kernel.</a>
    
  </div>
  
</aside>
	</main><footer>
  <a href="http://localhost:4000/license">MIT License</a>
  <a href="https://pages.github.com/">This Page is generated with GitHubPages</a>
</footer>
<!--
<script src="http://localhost:4000/js/ScrollMagic.min.js""></script>
	<script src=" http://localhost:4000/js/debug.addIndicators.min.js""> </script> 

	<script>
    // init controller
    var controller = new ScrollMagic.Controller({ globalSceneOptions: { duration: 1500 } });
    // build scenes
    
  </script>
  -->
  <!-- --></body>
</html>
